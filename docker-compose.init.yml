services:

  certificate-manager:
    extends:
      file: certificate-manager/docker-compose.yml
      service: certificate-manager
    volumes:
      - .wg-rusteze-docker/certs:/app/certs
    environment:
      COUNTRY: "XX"
      STATE: "XXX"
      LOCALITY: "XXX"
      ORGANIZATION: "XXX"
      ORGANIZATIONAL_UNIT: "XXX"
      ROOT_CN: "certificate-manager@XXX"
    command: [ "127.0.0.1", "localhost" ]

  wg-rusteze-init:
    container_name: wg-rusteze-init-cnt
    build:
      target: runner
    volumes:
      - .wg-rusteze-docker:/app/.wg-rusteze
    command: >
      init --no-prompt true
      --network-identifier wg-rusteze
      --network-subnet 10.0.34.0/24
      
      --agent-peer-name wg-rusteze-host
      --agent-local-address 0.0.0.0
      --agent-local-enable-web-http true
      --agent-local-web-http-port 80
      --agent-local-enable-web-https true
      --agent-local-web-https-port 443
      --agent-local-web-https-tls-cert certs/servers/localhost/cert.pem
      --agent-local-web-https-tls-key certs/servers/localhost/key.pem
      --agent-local-enable-vpn true
      --agent-local-vpn-port 51820
      --agent-public-address 1.2.3.4
      --agent-public-vpn-port 51820
      --agent-internal-vpn-address 10.0.34.1
      --agent-local-vpn-outbound-interface eth0
      
      --agent-enable-web-password true
      --agent-web-password secret
      --agent-enable-dns true
      --agent-dns-server 1.1.1.1
      --agent-enable-mtu false
      --agent-mtu-value ""
      --agent-enable-script-pre-up false
      --agent-script-pre-up-line ""
      --agent-enable-script-post-up false
      --agent-script-post-up-line ""
      --agent-enable-script-pre-down false
      --agent-script-pre-down-line ""
      --agent-enable-script-post-down false
      --agent-script-post-down-line ""
      
      --default-enable-dns true
      --default-dns-server 1.1.1.1
      --default-enable-mtu false
      --default-mtu-value ""
      --default-enable-script-pre-up false
      --default-script-pre-up-line ""
      --default-enable-script-post-up false
      --default-script-post-up-line ""
      --default-enable-script-pre-down false
      --default-script-pre-down-line ""
      --default-enable-script-post-down false
      --default-script-post-down-line ""
      --default-enable-persistent-keepalive true
      --default-persistent-keepalive-period 25

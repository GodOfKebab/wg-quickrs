services:

  certificate-manager:
    container_name: certificate-manager-cnt
    build:
      context: ./cert
    volumes:
      - .wg-rusteze-docker/certs:/app/certs
    environment:
      # TLS Certificate settings...
      COUNTRY: "XX"
      STATE: "XXX"
      LOCALITY: "XXX"
      ORGANIZATION: "XXX"
      ORGANIZATIONAL_UNIT: "XXX"
      ROOT_CN: "certificate-manager@XXX"
    command: [ "127.0.0.1", "localhost" ]  # use comma-seperated FQDNs to create TLS certificates

  wg-rusteze-init:
    container_name: wg-rusteze-init-cnt
    build:
      target: initializer
    environment:
      NETWORK_IDENTIFIER: wg-rusteze
      NETWORK_SUBNET: 10.0.34.0/24

      AGENT_PEER_NAME: wg-rusteze-host
      AGENT_LOCAL_ADDRESS: 0.0.0.0
      AGENT_LOCAL_ENABLE_WEB_HTTP: true
      AGENT_LOCAL_WEB_HTTP_PORT: 80
      AGENT_LOCAL_ENABLE_WEB_HTTPS: true
      AGENT_LOCAL_WEB_HTTPS_PORT: 443
      AGENT_LOCAL_WEB_HTTPS_TLS_CERT: certs/servers/localhost/cert.pem
      AGENT_LOCAL_WEB_HTTPS_TLS_KEY: certs/servers/localhost/key.pem
      AGENT_LOCAL_ENABLE_VPN: true
      AGENT_LOCAL_VPN_PORT: 51820
      AGENT_LOCAL_VPN_OUTBOUND_INTERFACE: "eth0"
      AGENT_PUBLIC_ADDRESS: 1.2.3.4
      AGENT_PUBLIC_VPN_PORT: 51820
      AGENT_INTERNAL_VPN_ADDRESS: 10.0.34.1
      AGENT_ENABLE_WEB_PASSWORD: true
      AGENT_WEB_PASSWORD: "secret"
      AGENT_ENABLE_DNS: true
      AGENT_DNS_SERVER: 1.1.1.1
      AGENT_ENABLE_MTU: false
      AGENT_MTU_VALUE: ""
      AGENT_ENABLE_SCRIPT_PRE_UP: false
      AGENT_SCRIPT_PRE_UP_LINE: ""
      AGENT_ENABLE_SCRIPT_POST_UP: false
      AGENT_SCRIPT_POST_UP_LINE: ""
      AGENT_ENABLE_SCRIPT_PRE_DOWN: false
      AGENT_SCRIPT_PRE_DOWN_LINE: ""
      AGENT_ENABLE_SCRIPT_POST_DOWN: false
      AGENT_SCRIPT_POST_DOWN_LINE: ""

      DEFAULT_ENABLE_DNS: true
      DEFAULT_DNS_SERVER: 1.1.1.1
      DEFAULT_ENABLE_MTU: false
      DEFAULT_MTU_VALUE: ""
      DEFAULT_ENABLE_SCRIPT_PRE_UP: false
      DEFAULT_SCRIPT_PRE_UP_LINE: ""
      DEFAULT_ENABLE_SCRIPT_POST_UP: false
      DEFAULT_SCRIPT_POST_UP_LINE: ""
      DEFAULT_ENABLE_SCRIPT_PRE_DOWN: false
      DEFAULT_SCRIPT_PRE_DOWN_LINE: ""
      DEFAULT_ENABLE_SCRIPT_POST_DOWN: false
      DEFAULT_SCRIPT_POST_DOWN_LINE: ""
      DEFAULT_ENABLE_PERSISTENT_KEEPALIVE: true
      DEFAULT_PERSISTENT_KEEPALIVE_PERIOD: 25
    volumes:
      - .wg-rusteze-docker:/app/.wg-rusteze

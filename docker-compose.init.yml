services:

  certificate-manager:
    image: godofkebab/certificate-manager
    volumes:
      - .wg-quickrs-docker/certs:/app/certs
    environment:
      COUNTRY: "XX"
      STATE: "XXX"
      LOCALITY: "XXX"
      ORGANIZATION: "XXX"
      ORGANIZATIONAL_UNIT: "XXX"
      ROOT_CN: "certificate-manager@XXX"
    command: [ "127.0.0.1", "localhost" ]

  wg-quickrs-init:
    container_name: wg-quickrs-init-cnt
    build:
      target: runner
    volumes:
      - .wg-quickrs-docker:/app/.wg-quickrs
    command: >
      init --no-prompt true
      --network-identifier wg-quickrs
      --network-subnet     10.0.34.0/24

      --agent-web-address          0.0.0.0
      --agent-web-http-enabled     true
      --agent-web-http-port        80
      --agent-web-https-enabled    true
      --agent-web-https-port       443
      --agent-web-https-tls-cert   certs/servers/localhost/cert.pem
      --agent-web-https-tls-key    certs/servers/localhost/key.pem
      --agent-web-password-enabled true
      --agent-web-password         TODO_YOUR_PASSWORD_TODO
      --agent-vpn-enabled          true
      --agent-vpn-port             51820
      --agent-vpn-gateway          eth0
      --agent-firewall-enabled     true
      --agent-firewall-utility     /usr/sbin/iptables
      
      --agent-peer-name                     wg-quickrs-host
      --agent-peer-vpn-endpoint             TODO_YOUR_PUBLIC_IP_TODO:51820
      --agent-peer-vpn-internal-address     10.0.34.1
      --agent-peer-dns-enabled              true
      --agent-peer-dns-server               1.1.1.1
      --agent-peer-mtu-enabled              false
      --agent-peer-mtu-value                ""
      --agent-peer-script-pre-up-enabled    false
      --agent-peer-script-pre-up-line       ""
      --agent-peer-script-post-up-enabled   false
      --agent-peer-script-post-up-line      ""
      --agent-peer-script-pre-down-enabled  false
      --agent-peer-script-pre-down-line     ""
      --agent-peer-script-post-down-enabled false
      --agent-peer-script-post-down-line    ""

      --default-peer-dns-enabled                        true
      --default-peer-dns-server                         1.1.1.1
      --default-peer-mtu-enabled                        false
      --default-peer-mtu-value                          ""
      --default-peer-script-pre-up-enabled              false
      --default-peer-script-pre-up-line                 ""
      --default-peer-script-post-up-enabled             false
      --default-peer-script-post-up-line                ""
      --default-peer-script-pre-down-enabled            false
      --default-peer-script-pre-down-line               ""
      --default-peer-script-post-down-enabled           false
      --default-peer-script-post-down-line              ""
      --default-connection-persistent-keepalive-enabled true
      --default-connection-persistent-keepalive-period  25
